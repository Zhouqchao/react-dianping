{"version":3,"sources":["containers/User/components/UserHeader/index.js","containers/User/components/OrderItem/index.js","containers/User/components/UserMain/index.js","components/Confirm/index.js","containers/User/index.js","components/Loading/index.js"],"names":["UserHeader","this","props","handleBack","logout","className","onClick","Component","OrderItem","renderStars","star","setStar","userActions","map","item","index","key","handleSubmitComment","currentOrder","comment","orderId","id","hideCommentSection","commentOrder","getOrders","resetCurrentOrder","patchOrder","orderActions","time","Date","now","then","commentId","response","handleCancelComment","renderComment","setComment","value","onChange","e","target","type","handleComment","orders","setCurrentOrderId","setCurrentOrderCommentId","showCommentSection","data","tag","statusText","orderPicUrl","category","channel","title","text","deleteOrder","isShowCommentSection","src","alt","connect","state","getIsShowCommentSection","getStar","getComment","getCurrentOrder","dispatch","bindActionCreators","tabTitles","UserMain","renderOrderList","renderEmpty","currentTab","handleTabClick","isFetching","Loading","length","Confirm","handleCancel","handleConfirm","User","history","push","tab","setCurrentTab","setShowConfirm","handleDeleteOrder","showConfirm","loginActions","withRouter","getCurrentTab","getIsFetching","getShowConfirm"],"mappings":"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","file":"static/js/7.17cae94c.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport \"./style.css\";\n\nclass UserHeader extends Component {\n  render() {\n    const { handleBack, logout } = this.props;\n    return (\n      <div className=\"user-header__wrapper\">\n        <div className=\"user-header\">\n          <div className=\"user-header__back\" onClick={handleBack}>\n            首页\n          </div>\n          <div className=\"user-header__tabs\">\n            <div className=\"user-header__tab user-header__tab--selected\">\n              订单\n            </div>\n            <div className=\"user-header__tab\">抵用券</div>\n          </div>\n          <span className=\"user-header__logout\" onClick={logout}>\n            注销\n          </span>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default UserHeader;\n","import React, { Component } from \"react\";\nimport \"./style.css\";\nimport { connect } from \"react-redux\";\nimport {\n  actions as userActions,\n  getIsShowCommentSection,\n  getStar,\n  getComment,\n  getCurrentOrder\n} from \"../../../../redux/modules/user\";\nimport { actions as orderActions } from \"../../../../redux/modules/entities/orders\";\nimport { bindActionCreators } from \"redux\";\n\nclass OrderItem extends Component {\n  renderStars = () => {\n    const { star } = this.props;\n    const { setStar } = this.props.userActions;\n    const stars = [1, 2, 3, 4, 5];\n\n    return (\n      <ul className=\"order-comment__stars\">\n        {stars.map((item, index) => {\n          const className =\n            index < star ? \"order-comment__star--light\" : \"order-comment__star\";\n\n          return (\n            <li\n              key={index}\n              onClick={() => setStar(index + 1)}\n              className={className}\n            >\n              ★\n            </li>\n          );\n        })}\n      </ul>\n    );\n  };\n  handleSubmitComment = () => {\n    const {\n      currentOrder: { comment, star, id: orderId }\n    } = this.props;\n    const {\n      hideCommentSection,\n      commentOrder,\n      getOrders,\n      resetCurrentOrder\n    } = this.props.userActions;\n    const { patchOrder } = this.props.orderActions;\n\n    const newComment = {\n      comment,\n      star,\n      time: Date.now()\n    };\n\n    commentOrder(newComment).then(({ response: { id: commentId } }) => {\n      patchOrder(orderId, commentId).then(() => {\n        hideCommentSection();\n        resetCurrentOrder();\n        getOrders();\n      });\n    });\n  };\n  handleCancelComment = () => {\n    const { hideCommentSection, resetCurrentOrder } = this.props.userActions;\n\n    hideCommentSection();\n    resetCurrentOrder();\n  };\n  renderComment = () => {\n    const { setComment } = this.props.userActions;\n    const { comment } = this.props;\n\n    return (\n      <div className=\"order-comment\">\n        <textarea\n          className=\"order-comment__text\"\n          value={comment}\n          onChange={e => setComment(e.target.value)}\n        />\n        {this.renderStars()}\n        <button\n          type=\"button\"\n          className=\"order-comment__btn order-comment__btn--submit\"\n          onClick={this.handleSubmitComment}\n        >\n          提交\n        </button>\n        <button\n          type=\"button\"\n          className=\"order-comment__btn order-comment__btn--cancel\"\n          onClick={this.handleCancelComment}\n        >\n          取消\n        </button>\n      </div>\n    );\n  };\n  handleComment = orderId => {\n    const { orders } = this.props;\n    this.props.userActions.setCurrentOrderId(orderId);\n    this.props.userActions.setCurrentOrderCommentId(orders);\n    this.props.userActions.showCommentSection(orders);\n  };\n  render() {\n    const {\n      id,\n      commentId,\n      statusText: tag,\n      orderPicUrl,\n      channel: category,\n      title,\n      text\n    } = this.props.data;\n    const { deleteOrder, isShowCommentSection, currentOrder } = this.props;\n\n    return (\n      <div className=\"order-item\">\n        <div className=\"order-item__header\">\n          <div className=\"order-item__title\">{title}</div>\n        </div>\n        <div className=\"order-item__main\">\n          <div className=\"order-item__img-wrapper\">\n            <img className=\"order-item__img\" src={orderPicUrl} alt={title} />\n            <span className=\"order-item__tag\">{tag}</span>\n          </div>\n          <div className=\"order-item__content\">\n            {text.map((item, index) => (\n              <div className=\"order-item__line\" key={index}>\n                {item}\n              </div>\n            ))}\n          </div>\n        </div>\n        <div className=\"order-item__footer\">\n          <span className=\"order-item__category\">{category}</span>\n          <div className=\"order-item__btns\">\n            {!commentId ? (\n              <button\n                type=\"button\"\n                className=\"order-item__btn order-item__btn--review\"\n                onClick={() => this.handleComment(id)}\n              >\n                评价\n              </button>\n            ) : null}\n            <button\n              type=\"button\"\n              className=\"order-item__btn order-item__btn--delete\"\n              onClick={() => deleteOrder(id)}\n            >\n              删除\n            </button>\n          </div>\n        </div>\n        {isShowCommentSection && id === currentOrder.id && this.renderComment()}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  isShowCommentSection: getIsShowCommentSection(state),\n  star: getStar(state),\n  comment: getComment(state),\n  currentOrder: getCurrentOrder(state)\n});\n\nconst mapDispatchToProps = dispatch => ({\n  userActions: bindActionCreators(userActions, dispatch),\n  orderActions: bindActionCreators(orderActions, dispatch)\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OrderItem);\n","import React, { Component } from \"react\";\nimport \"./style.css\";\nimport OrderItem from \"../OrderItem\";\nimport Loading from \"../../../../components/Loading\";\n\nconst tabTitles = [\"全部订单\", \"代付款\", \"可使用\", \"退款/售后\"];\n\nclass UserMain extends Component {\n  renderOrderList = data => {\n    return data.map(item => (\n      <OrderItem\n        key={item.id}\n        data={item}\n        orders={data}\n        deleteOrder={this.props.deleteOrder}\n      ></OrderItem>\n    ));\n  };\n  renderEmpty = () => {\n    return (\n      <div className=\"user-main__empty\">\n        <i className=\"user-main__icon--empty\"></i>\n        <div className=\"user-main__text\">\n          <p className=\"user-main__text--1\">您还没有相关订单</p>\n          <p className=\"user-main__text--2\">去逛逛看还有哪些想买的</p>\n        </div>\n      </div>\n    );\n  };\n  render() {\n    const { currentTab, data, handleTabClick, isFetching } = this.props;\n\n    return (\n      <div className=\"user-main\">\n        <div className=\"user-main__menu\">\n          {tabTitles.map((title, index) => (\n            <div\n              key={index}\n              className=\"user-main__tab\"\n              onClick={() => handleTabClick(index)}\n            >\n              <span\n                className={\n                  currentTab === index\n                    ? \"user-main__title user-main__title--active\"\n                    : \"user-main__title\"\n                }\n              >\n                {title}\n              </span>\n            </div>\n          ))}\n        </div>\n        <div className=\"user-main__content\">\n          {isFetching ? (\n            <Loading />\n          ) : data && data.length > 0 ? (\n            this.renderOrderList(data)\n          ) : (\n            this.renderEmpty()\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default UserMain;\n","import React, { Component } from \"react\";\nimport \"./style.css\";\n\nclass Confirm extends Component {\n  render() {\n    const { title, handleCancel, handleConfirm } = this.props;\n    return (\n      <div className=\"confirm\">\n        <div className=\"confirm__box\">\n          <div className=\"confirm__title\">{title}</div>\n          <div className=\"confirm__btns\">\n            <button\n              type=\"button\"\n              className=\"confirm__btn confirm__btn--cancel\"\n              onClick={handleCancel}\n            >\n              取消\n            </button>\n            <button\n              type=\"button\"\n              className=\"confirm__btn confirm__btn--confirm\"\n              onClick={handleConfirm}\n            >\n              确认\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Confirm;\n","import React, { Component } from \"react\";\nimport \"./style.css\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport UserHeader from \"./components/UserHeader\";\nimport UserMain from \"./components/UserMain\";\nimport Confirm from \"../../components/Confirm\";\nimport { bindActionCreators } from \"redux\";\nimport {\n  getOrders,\n  getIsFetching,\n  getCurrentTab,\n  getCurrentOrder,\n  actions as userActions,\n  getShowConfirm\n} from \"../../redux/modules/user\";\nimport { actions as loginActions } from \"../../redux/modules/login\";\n\nclass User extends Component {\n  handleBack = () => {\n    this.props.history.push(\"/\");\n  };\n  handleTabClick = tab => {\n    this.props.userActions.setCurrentTab(tab);\n  };\n  componentDidMount() {\n    this.props.userActions.getOrders();\n  }\n  handleCancel = () => {\n    this.props.userActions.setShowConfirm(false);\n  };\n  handleConfirm = () => {\n    const {\n      currentOrder: { id }\n    } = this.props;\n    // 删除订单\n    this.props.userActions.deleteOrder(id).then(() => {\n      // 请求最新订单数据\n      this.props.userActions.getOrders();\n    });\n    // 隐藏confirm\n    this.props.userActions.setShowConfirm(false);\n  };\n  handleDeleteOrder = orderId => {\n    this.props.userActions.setShowConfirm(true);\n    this.props.userActions.setCurrentOrderId(orderId);\n  };\n  render() {\n    const { currentTab, orders, isFetching, showConfirm } = this.props;\n    const { logout } = this.props.loginActions;\n\n    return (\n      <div className=\"user\">\n        <UserHeader handleBack={this.handleBack} logout={logout} />\n        <UserMain\n          data={orders}\n          currentTab={currentTab}\n          isFetching={isFetching}\n          handleTabClick={this.handleTabClick}\n          deleteOrder={this.handleDeleteOrder}\n        />\n        {showConfirm && (\n          <Confirm\n            title=\"确认删除该订单吗?\"\n            handleCancel={this.handleCancel}\n            handleConfirm={this.handleConfirm}\n          />\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  currentTab: getCurrentTab(state),\n  currentOrder: getCurrentOrder(state),\n  orders: getOrders(state),\n  isFetching: getIsFetching(state),\n  showConfirm: getShowConfirm(state)\n});\n\nconst mapDispatchToProps = dispatch => ({\n  userActions: bindActionCreators(userActions, dispatch),\n  loginActions: bindActionCreators(loginActions, dispatch)\n});\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(User));\n","import React, { Component } from \"react\";\nimport \"./style.css\";\n\nclass Loading extends Component {\n  render() {\n    return (\n      <div className=\"loading\">\n        <div className=\"loading__img\"></div>\n        <span>正在加载...</span>\n      </div>\n    );\n  }\n}\n\nexport default Loading;\n"],"sourceRoot":""}